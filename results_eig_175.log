WARNING:tensorflow:From /home/student/Documents/Qiyuan/tf2py2/lib/python2.7/site-packages/tensorflow_core/python/compat/v2_compat.py:65: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
2020-12-08 06:26:18.545886: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-08 06:26:18.571909: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2020-12-08 06:26:18.571965: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: zinc
2020-12-08 06:26:18.571977: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: zinc
2020-12-08 06:26:18.572029: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 450.80.2
2020-12-08 06:26:18.572066: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 450.80.2
2020-12-08 06:26:18.572076: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 450.80.2
2020-12-08 06:26:18.572519: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-12-08 06:26:18.581243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3192565000 Hz
2020-12-08 06:26:18.582834: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e545e47c30 executing computations on platform Host. Devices:
2020-12-08 06:26:18.582855: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
Dataset already exists. Loading from /home/student/Documents/Qiyuan/tf2py2/ltocode/experiments/eig1/trainset_eig.pkl. 
Comparation of finding eigenvalues using different policies starts: 
Log2(problem size) =  3.1699250014423126
Real largest(norm) eigenvalue:  -1.0
Eigs have been found using GradientDescentPolicy,   initial cost:  2.716e+00 final cost:  2.659e-03  iteration_num:  175  eig1:  0.30580548049592915  eig:  -1.0  err:  0.0
Eigs have been found using ConjugateGradientPolicy, initial cost:  2.716e+00 final cost:  nan  iteration_num:  161  eig1:  nan  eig:  nan  err:  nan
Eigs have been found using MomentumPolicy,          initial cost:  2.716e+00 final cost:  1.271e-16  iteration_num:  24  eig1:  0.4926281490423317  eig:  -1.0  err:  0.0
Eigs have been found using Learned Policy 0,        initial cost:  2.716e+00 final cost:  1.422e-03  iteration_num:  175  eig1:  0.28742524389651375  eig:  -1.0  err:  0.0
===================================== Done =======================================
Log2(problem size) =  4.0
Real largest(norm) eigenvalue:  -1.5
Eigs have been found using GradientDescentPolicy,   initial cost:  2.717e+00 final cost:  1.327e-02  iteration_num:  175  eig1:  -5.567700590164556  eig:  -1.4945740122244786  err:  0.04350962178685383
Eigs have been found using ConjugateGradientPolicy, initial cost:  2.717e+00 final cost:  2.637e+00  iteration_num:  175  eig1:  -0.23782291076923565  eig:  -1.2714838474698447  err:  0.30539455406069743
Eigs have been found using MomentumPolicy,          initial cost:  2.717e+00 final cost:  3.127e-12  iteration_num:  175  eig1:  -23.02975031042574  eig:  -1.4908820561566043  err:  0.05505767509055546
Eigs have been found using Learned Policy 0,        initial cost:  2.717e+00 final cost:  6.198e-03  iteration_num:  175  eig1:  -6.603230989790299  eig:  -1.4961575738657455  err:  0.030478562182994984
===================================== Done =======================================
Log2(problem size) =  5.169925001442312
Real largest(norm) eigenvalue:  -1.8090169943749475
Eigs have been found using GradientDescentPolicy,   initial cost:  2.718e+00 final cost:  1.250e+00  iteration_num:  175  eig1:  -5.077039130639262  eig:  -1.7683616786542469  err:  0.0899946833980802
Eigs have been found using ConjugateGradientPolicy, initial cost:  2.718e+00 final cost:  2.716e+00  iteration_num:  175  eig1:  -0.030026961598754554  eig:  -1.1584056380524732  err:  0.4176592360385617
Eigs have been found using MomentumPolicy,          initial cost:  2.718e+00 final cost:  1.738e-05  iteration_num:  175  eig1:  -43.10757443277004  eig:  -1.7538003233283823  err:  0.1031944586296488
Eigs have been found using Learned Policy 0,        initial cost:  2.718e+00 final cost:  1.453e-01  iteration_num:  175  eig1:  -13.744391057849468  eig:  -1.7616470553524508  err:  0.11682385892255776
===================================== Done =======================================
Log2(problem size) =  6.0
Real largest(norm) eigenvalue:  -1.9009688679024197
Eigs have been found using GradientDescentPolicy,   initial cost:  2.718e+00 final cost:  2.707e+00  iteration_num:  175  eig1:  -0.128268642245967  eig:  -1.5032419589450856  err:  0.2696795592293951
Eigs have been found using ConjugateGradientPolicy, initial cost:  2.718e+00 final cost:  2.718e+00  iteration_num:  175  eig1:  -0.019795180006865636  eig:  -0.9905839099616881  err:  0.4568662826967456
Eigs have been found using MomentumPolicy,          initial cost:  2.718e+00 final cost:  7.405e-04  iteration_num:  175  eig1:  -55.46421299572035  eig:  -1.743296183250515  err:  0.13896381530031018
Eigs have been found using Learned Policy 0,        initial cost:  2.718e+00 final cost:  2.651e+00  iteration_num:  175  eig1:  -0.6560128808076363  eig:  -1.1408091091607064  err:  0.5393264407129507
===================================== Done =======================================
Log2(problem size) =  6.643856189774725
Real largest(norm) eigenvalue:  -1.939692620785907
Eigs have been found using GradientDescentPolicy,   initial cost:  2.718e+00 final cost:  2.717e+00  iteration_num:  175  eig1:  -0.04465312222353843  eig:  -1.11578514579142  err:  0.37003739514180845
Eigs have been found using ConjugateGradientPolicy, initial cost:  2.718e+00 final cost:  2.718e+00  iteration_num:  175  eig1:  -0.012785778135640705  eig:  -0.8638876253576803  err:  0.46515717489318154
Eigs have been found using MomentumPolicy,          initial cost:  2.718e+00 final cost:  3.942e-03  iteration_num:  175  eig1:  -68.01689241555269  eig:  -1.5746870079700335  err:  0.15386280616249537
Eigs have been found using Learned Policy 0,        initial cost:  2.718e+00 final cost:  2.711e+00  iteration_num:  175  eig1:  -0.39936720517960544  eig:  -0.2915555298025635  err:  0.827961275623923
===================================== Done =======================================
Log2(problem size) =  7.400879436282184
Real largest(norm) eigenvalue:  (-1.965925826289084+0j)
Eigs have been found using GradientDescentPolicy,   initial cost:  2.718e+00 final cost:  2.717e+00  iteration_num:  175  eig1:  -0.034070661328129304  eig:  -1.2167505387945283  err:  0.3947057494110484
Eigs have been found using ConjugateGradientPolicy, initial cost:  2.718e+00 final cost:  2.718e+00  iteration_num:  175  eig1:  -0.011494507352737451  eig:  -1.0305026988003874  err:  0.4687254107124645
Eigs have been found using MomentumPolicy,          initial cost:  2.718e+00 final cost:  5.377e-02  iteration_num:  175  eig1:  -74.18033269788556  eig:  -1.723556741932213  err:  0.12705617237932995
Eigs have been found using Learned Policy 0,        initial cost:  2.718e+00 final cost:  2.714e+00  iteration_num:  175  eig1:  -0.6543988523281871  eig:  -0.1756021103941713  err:  0.898418402126208
===================================== Done =======================================
Log2(problem size) =  8.339850002884624
Real largest(norm) eigenvalue:  -1.982973099683898
Eigs have been found using GradientDescentPolicy,   initial cost:  2.718e+00 final cost:  2.718e+00  iteration_num:  175  eig1:  -0.03656107467371105  eig:  -1.0948344012570672  err:  0.3950297263948318
Eigs have been found using ConjugateGradientPolicy, initial cost:  2.718e+00 final cost:  2.718e+00  iteration_num:  175  eig1:  -0.023709607226972337  eig:  -1.0263327250379617  err:  0.42043452392940134
Eigs have been found using MomentumPolicy,          initial cost:  2.718e+00 final cost:  2.691e+00  iteration_num:  175  eig1:  -1.4691325247839315  eig:  -1.5231679677204064  err:  0.2115766946721474
Eigs have been found using Learned Policy 0,        initial cost:  2.718e+00 final cost:  2.715e+00  iteration_num:  175  eig1:  -1.3691065185469986  eig:  -0.09626159130104721  err:  0.9244908641670065
===================================== Done =======================================
results saved as ./results.npy !
